
***************RECOVERY PENDING*******************************************
--1. PONER LA BD EN ESTADO DE EMERGENCIA

ALTER DATABASE NombreBaseDeDatos SET EMERGENCY

--2.PONER LA BD EN ESTADO EXCLUSIVO

ALTER DATABASE NombreBaseDeDatos SET SINGLE_USER

--3. RECONSTRUIR EL LOG

ALTER DATABASE NombreBaseDatos REBUILD LOG ON
(NAME = N'NombreLOG', FileName = N'RutaLOG')
GO

--4. Verificamos que el archivo del LOG se ha creado en la ruta de la Query

--5. ESTABLECEMOS LA BD EN MODO MULTIUSUARIO

ALTER DATABASE NombreBaseDatos SET ONLINE, MULTI_USER

**************REPARACION**************************************************
--1. PONER LA BD EN ESTADO DE EMERGENCIA
ALTER DATABASE NombreBaseDeDatos SET EMERGENCY

--2. INTENTAR REPARAR
DBCC CHECKDB(NombreBaseDeDatos,REPAIR_REBUILD)

--2.1. SI LA REPARACION ANTERIOR NO ES POSIBLE
ALTER DATABASE NombreBaseDeDatos SET SINGLE_USER WITH ROLLBACK IMMEDIATE;ALTER DATABASE NombreBaseDeDatos SET READ_ONLY
DBCC CHECKDB(NombreBaseDeDatos,REPAIR_ALLOW_DATA_LOSS)
ALTER DATABASE NombreBaseDatos SET ONLINE, MULTI_USER

--3. EJECUTAR UN CHEQUEO PARA CORROBORAR LA REPARACION
DBCC CHECKDB(NombreBaseDeDatos)



